rule_id: 8868ae34-5a57-4c0e-b9de-6561a369d4e1
#//RULE-HIPAA-36 — VIP/Celebrity Patient Snooping - Unauthorized Access
#//Requirement: HIPAA Privacy Rule §164.502(a) - Unauthorized Access
#//Objective: Detect inappropriate access to high-profile patient records
#//Data sources: EHR audit logs, VIP patient flagging system
#//ECS fields used: event.action, user.name, event.original, event.original  # FIXME: patient.id not available
#//Healthcare field validation: Verify EHR/EMR fields exist in your indices (event.original  # FIXME: patient.id not available, encounter.id, etc.)
#//Tuning notes: Flag VIP patients; monitor access patterns; require legitimate relationship

name: "Unauthorized Access to VIP/Celebrity Patient Records"
description: |
  Identifies inappropriate access to medical records of VIP patients, celebrities,
  public figures, or high-profile individuals without legitimate treatment relationship
  or authorization. HIPAA §164.502(a) prohibits access without authorized purpose.
  Detects chart opens of flagged VIP patients by staff not assigned to their care,
  unusual access volumes to celebrity records, or access outside clinical departments.
  "Snooping" on famous patients is common HIPAA violation. Monitor VIP patient
  access patterns and correlate with care team assignments and clinical necessity.
type: esql
params: '{}'
schedule_interval: 10m
index:
  - winlogbeat-*
  - auditbeat-*
  - filebeat-ehr-*
query_language: esql
query: |
  FROM   | WHERE event.action RLIKE "(?i).*(chart.*open|record.*access|patient.*view).*"
    AND (
      event.original RLIKE "(?i).*(vip.*patient|celebrity|public.*figure|confidential.*patient|restricted.*access).*"
      OR event.original  # FIXME: patient.tags not available IN ["vip", "celebrity", "restricted"]
    )
  | WHERE NOT (
      user.name RLIKE "(?i).*(assigned.*provider|care.*team|authorized.*clinician).*"
      OR event.original RLIKE "(?i).*(treatment.*team|legitimate.*relationship).*"
    )
  | STATS unauthorized_access = COUNT(*),
          accessing_users = VALUES(user.name),
          user_departments = VALUES(event.original  # FIXME: user.department not available),
          access_times = VALUES(@timestamp)
    BY user.name, event.original  # FIXME: patient.id not available
  | WHERE unauthorized_access > 0
  | EVAL risk_score = CASE(
      unauthorized_access > 5, 100,
      user_departments NOT RLIKE "(?i).*(clinical|nursing|physician).*", 95,
      unauthorized_access > 1, 90,
      85
    )
  | KEEP agent_id, user.name, event.original  # FIXME: patient.id not available, unauthorized_access, user_departments, accessing_users, risk_score
  | SORT unauthorized_access DESC
enabled: false
tags:
  - hipaa
  - privacy_rule
  - section_164_502
  - unauthorized_access
  - vip_patient
  - snooping
  - celebrity
severity: critical
risk_score: 100
references:
  - "45 CFR §164.502(a) - Uses and Disclosures - General Rules"
  - "45 CFR §164.514(d) - Minimum Necessary"
  - "OCR Resolution Agreements - Snooping Cases"
nist: ["AC-3"]
gdpr: ["32"]
pci_dss: []
hipaa: ["164.502.a"]
mitre_attack:
  TA0009:
    T1530: []