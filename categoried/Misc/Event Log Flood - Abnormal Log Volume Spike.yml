rule_id: 213827e8-fd1c-4c4a-94a0-9649d6ad3907

name: "Event Log Flood - Abnormal Log Volume Spike"
description: |
  This rule detects sudden spikes in event log volume for specific event datasets, which may indicate log flooding attacks, application errors, or attempts to hide malicious activity in noise. Excessive logging can also impact SIEM performance and storage.
  
#  Log flooding can be used to overwhelm monitoring systems, hide specific malicious events, or cause denial of service on logging infrastructure. Detecting volume anomalies helps maintain log integrity.
#  
#  False positives may occur during legitimate high-activity periods, application deployments, or system updates. Baseline normal log volumes per dataset.
#  
#  Triage steps: (1) Identify which event dataset is flooding, (2) Review sample events for patterns or anomalies, (3) Check if flooding correlates with other suspicious activity, (4) Investigate the source hosts or applications generating excessive logs.
type: esql
params: '{}'
schedule_interval: 10m
index:
  - winlogbeat-*
  - auditbeat-*
  - filebeat-*
  - metricbeat-*
query_language: esql
query: |
  FROM winlogbeat-*, auditbeat-*, filebeat-*, metricbeat-*
  | WHERE @timestamp >= NOW() - 15 minutes
  | EVAL hostn = COALESCE(host.name, winlog.computer_name)
  | EVAL dataset = COALESCE(event.dataset, event.module, "unknown")
  | STATS 
      event_count = COUNT(*),
      unique_hosts = COUNT_DISTINCT(hostn),
      sample_events = VALUES(SUBSTRING(event.original, 0, 160))
    BY dataset, hostn
  // Threshold: 500+ events of same type in 15 minutes from one host
  | WHERE event_count >= 500
  | EVAL risk_score = CASE(
      event_count >= 1000, 85,
      event_count >= 750, 75,
      65
    )
  | SORT risk_score DESC
  | LIMIT 100
enabled: false
tags:
  - Log Flooding
  - Anomaly Detection
  - DoS
  - Defense Evasion
severity: medium
risk_score: 68
references:
  - "https://attack.mitre.org/techniques/T1562/001/"
nist: ["AU-12", "AU-6", "SI-4"]
gdpr: ["Article 32"]
pci_dss: ["10.5"]
mitre_attack:
  TA0005:
    T1562: ["T1562.001"]