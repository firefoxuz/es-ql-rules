rule_id: 39138a15-a091-4311-8aac-2a7367dfb1f2
name: ESET Protect - Unhandled Security Threats
description: |
  Ushbu qoida ESET tomonidan detect qilingan lekin handle qilinmagan threat'larni aniqlaydi.
  Bu incomplete remediation yoki persistent threat belgisi.
  Qonuniy holatlar: user postponement, manual intervention required, policy configuration.
  SOC triage bosqichlari:
  - Unhandled threat type va reason'ni aniqlang
  - Threat persistence duration'ni tahlil qiling
  - Manual intervention requirement'ni assess qiling
  - Host compromise risk'ini baholang
  - Force remediation yoki isolation zarurligini aniqlang
type: esql
params: '{}'
schedule_interval: 15m
index:
- filebeat-eset_protect-*
query_language: esql
query: |
  FROM filebeat-eset_protect-*
  | WHERE @timestamp >= NOW() - 2 hours
  | WHERE data_stream.dataset == "eset_protect.event"
  | WHERE eset_protect.event.is_handled == false OR eset_protect.event.threat_handled == false
  | WHERE eset_protect.event.severity RLIKE "(?i)(warning|error|critical|fatal)"
  | STATS
      event_count = COUNT(*),
      threat_names = VALUES(eset_protect.event.threat_name),
      threat_types = VALUES(eset_protect.event.threat_type),
      object_types = VALUES(eset_protect.event.object_type),
      severities = VALUES(eset_protect.event.severity),
      processes = VALUES(eset_protect.event.processname),
      users = VALUES(eset_protect.event.username)
    BY host.hostname, source.ip, bucket = DATE_TRUNC(30 minutes, @timestamp)
  | WHERE event_count >= 3
  | KEEP bucket, host.hostname, source.ip, event_count, threat_names, threat_types, object_types, severities, processes, users
  | SORT event_count DESC
  | LIMIT 100
enabled: true
tags:
- attack.persistence
- attack.t1547
- eset
- unhandled-threat
- incomplete-remediation
severity: high
risk_score: 75
references:
- "https://attack.mitre.org/techniques/T1547/"
nist: ["SI-3", "IR-4"]
pci_dss: ["5.2", "10.6.1"]
gdpr: ["35.7.d"]
mitre_attack:
  TA0003:
    T1547: []