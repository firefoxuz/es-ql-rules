name: ESET Protect - Suspicious Blocked Network Communication
description: |
  Ushbu qoida ESET tomonidan block qilingan suspicious network communication'larni aniqlaydi.
  Bu C2 communication, data exfiltration yoki malware callback urinishi belgisi (T1071, T1095).
  Qonuniy holatlar: false positive, legitimate blocked connection, overly restrictive policy.
  SOC triage bosqichlari:
  - Remote IP reputation va threat intelligence tekshiring
  - Communication protocol va port'ni tahlil qiling
  - Local process va executable path'ni examine qiling
  - C2 framework pattern'lari bormi aniqlang
  - Host-wide compromise indicator'larini qidiring
  - Network segmentation va containment zarurligini baholang
type: esql
params: '{}'
schedule_interval: 10m
index:
- filebeat-eset_protect-*
query_language: esql
query: |
  FROM filebeat-eset_protect-*
  | WHERE @timestamp >= NOW() - 45 minutes
  | WHERE data_stream.dataset == "eset_protect.detection"
  | WHERE eset_protect.detection.network_communication.remote.ip_address IS NOT NULL
  | WHERE eset_protect.detection.category RLIKE "(?i)(network|communication)"
  | STATS
      event_count = COUNT(*),
      remote_ips = VALUES(eset_protect.detection.network_communication.remote.ip_address),
      remote_ports = VALUES(eset_protect.detection.network_communication.remote.port),
      protocols = VALUES(eset_protect.detection.network_communication.protocol_name),
      directions = VALUES(eset_protect.detection.network_communication.direction),
      processes = VALUES(eset_protect.detection.context.process.path),
      detection_types = VALUES(eset_protect.detection.type_name)
    BY host.hostname, eset_protect.detection.context.device_uuid, bucket = DATE_TRUNC(10 minutes, @timestamp)
  | WHERE event_count >= 10
  | KEEP bucket, host.hostname, eset_protect.detection.context.device_uuid, event_count, remote_ips, remote_ports, protocols, directions, processes, detection_types
  | SORT event_count DESC
  | LIMIT 100
enabled: true
tags:
- attack.command-and-control
- attack.t1071
- attack.t1095
- eset
- network-communication
- c2
severity: high
risk_score: 80
references:
- "https://attack.mitre.org/techniques/T1071/"
- "https://attack.mitre.org/techniques/T1095/"
nist: ["SI-4", "SC-7"]
pci_dss: ["1.3.1", "10.6.1"]
gdpr: ["35.7.d"]
mitre_attack:
  TA0011:
    T1071: []
    T1095: []