rule_id: fdb95461-2c07-48d4-a2f1-4f4600c44f01
name: ESET Protect - Multiple Device Shutdown or Reboot Tasks
description: |
  Ushbu qoida ESET device management orqali bir nechta device'larga shutdown/reboot task'larni aniqlaydi.
  Bu unauthorized management action yoki insider threat belgisi bo'lishi mumkin (T1529).
  Qonuniy holatlar: scheduled maintenance, patch deployment, legitimate administrative tasks.
  SOC triage bosqichlari:
  - Task creator identity va authorization'ni verify qiling
  - Target device list va business impact'ni baholang
  - Task description va trigger time'ni review qiling
  - Change management approval borligini tekshiring
  - Unauthorized access yoki credential compromise belgilari
type: esql
params: '{}'
schedule_interval: 15m
index:
- filebeat-eset_protect-*
query_language: esql
query: |
  FROM filebeat-eset_protect-*
  | WHERE @timestamp >= NOW() - 2 hours
  | WHERE data_stream.dataset == "eset_protect.device_task"
  | WHERE eset_protect.device_task.action.name RLIKE "(?i)(shutdown|reboot|restart)"
  | STATS
      event_count = COUNT(*),
      actions = VALUES(eset_protect.device_task.action.name),
      descriptions = VALUES(eset_protect.device_task.description),
      display_names = VALUES(eset_protect.device_task.display_name),
      target_count = COUNT_DISTINCT(eset_protect.device_task.targets.devices_uuids),
      devices = VALUES(eset_protect.device_task.targets.devices_uuids)
    BY bucket = DATE_TRUNC(1 hour, @timestamp)
  | WHERE event_count >= 1 OR target_count >= 5
  | KEEP bucket, event_count, target_count, actions, descriptions, display_names, devices
  | SORT target_count DESC, event_count DESC
  | LIMIT 100
enabled: true
tags:
- attack.impact
- attack.t1529
- eset
- device-management
- availability
severity: medium
risk_score: 60
references:
- "https://attack.mitre.org/techniques/T1529/"
nist: ["AC-2", "AC-6"]
pci_dss: ["7.1", "10.2.2"]
gdpr: ["35.7.d"]
mitre_attack:
  TA0040:
    T1529: []