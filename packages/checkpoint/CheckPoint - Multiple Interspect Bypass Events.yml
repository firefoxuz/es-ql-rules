name: CheckPoint - Multiple Interspect Bypass Events
description: |
  Ushbu qoida CheckPoint Interspect'dan bypass bo'lgan connection'larni monitoring qiladi.
  Bypass transparently inspection'dan o'tgan connection'larni ko'rsatadi va security gap belgisi bo'lishi mumkin.
  Qonuniy holatlar: whitelisted traffic, performance optimization, encrypted traffic.
  SOC triage bosqichlari:
  - Bypass reason'ni aniqlang
  - Bypass qilingan traffic turini tahlil qiling
  - Destination'lar va application'larni tekshiring
  - Policy configuration'ni review qiling
  - Risk assessment qiling - inspection kerakmi yo'qmi
type: esql
params: '{}'
schedule_interval: 15m
index:
- checkpoint-*
query_language: esql
query: |
  FROM filebeat-checkpoint-*
  | WHERE @timestamp >= NOW() - 1 hour
  | WHERE checkpoint.fw_action == "Bypass"
  | STATS
      event_count = COUNT(*),
      dst_ips = VALUES(destination.ip),
      dst_ports = VALUES(destination.port),
      applications = VALUES(network.application),
      protocols = VALUES(network.protocol),
      zones = VALUES(observer.egress.zone)
    BY source.ip, bucket = DATE_TRUNC(10 minutes, @timestamp)
  | WHERE event_count >= 25
  | KEEP bucket, source.ip, event_count, dst_ips, dst_ports, applications, protocols, zones
  | SORT event_count DESC
  | LIMIT 100
enabled: true
tags:
- attack.defense-evasion
- checkpoint
- inspection-bypass
- policy-review
severity: medium
risk_score: 50
references:
- "https://attack.mitre.org/tactics/TA0005/"
nist: ["SC-7", "CA-7"]
pci_dss: ["1.3", "10.6.1"]
gdpr: ["35.7.d"]
mitre_attack:
  TA0005: {}