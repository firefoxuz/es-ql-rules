rule_id: 21cb1b87-399c-4b50-a1b6-5e3b7a6cec90
name: CheckPoint - VPN or Admin Login Failures
description: |
  Ushbu qoida CheckPoint Authorize (login) failure hodisalarini aniqlaydi.
  Bu brute force, credential stuffing yoki unauthorized access urinishi belgisi.
  Qonuniy holatlar: user parol xatosi, expired credentials, MFA issues.
  SOC triage bosqichlari:
  - User account va login type'ni identifikatsiya qiling
  - Source IP geo-location va reputation tekshiring
  - Login attempt time pattern'ini tahlil qiling
  - Muvaffaqiyatli login bo'lganmi keyinroq tekshiring
  - Account lockout yoki containment zarurligini baholang
type: esql
params: '{}'
schedule_interval: 10m
index:
- checkpoint-*
query_language: esql
query: |
  FROM filebeat-checkpoint-*
  | WHERE @timestamp >= NOW() - 45 minutes
  | WHERE checkpoint.fw_action == "Authorize"
  | WHERE checkpoint.auth_status == "Failure" OR event.outcome == "failure"
  | STATS
      event_count = COUNT(*),
      users = VALUES(user.name),
      dst_ips = VALUES(destination.ip),
      auth_methods = VALUES(checkpoint.auth_method),
      reject_categories = VALUES(checkpoint.reject_category),
      reject_reasons = VALUES(checkpoint.reject_id)
    BY source.ip, bucket = DATE_TRUNC(5 minutes, @timestamp)
  | WHERE event_count >= 10
  | KEEP bucket, source.ip, event_count, users, dst_ips, auth_methods, reject_categories, reject_reasons
  | SORT event_count DESC
  | LIMIT 100
enabled: true
tags:
- attack.credential-access
- attack.t1110
- checkpoint
- authentication-failure
severity: high
risk_score: 70
references:
- "https://attack.mitre.org/techniques/T1110/"
nist: ["AC-7", "IA-2"]
pci_dss: ["8.2.4", "10.2.4"]
gdpr: ["32.2"]
mitre_attack:
  TA0006:
    T1110: []