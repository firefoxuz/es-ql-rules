rule_id: 4e75a978-284b-4079-9c1e-31d1c17a007f
name: CheckPoint - DLP Data Exfiltration Attempts
description: |
  Ushbu qoida CheckPoint DLP (Data Loss Prevention) tomonidan aniqlangan data exfiltration urinishlarini monitoring qiladi.
  Sensitive data tashqariga chiqish urinishi (T1048, T1041).
  Qonuniy holatlar: authorized data transfer, business need, approved workflow.
  SOC triage bosqichlari:
  - Qaysi data type va category exfiltrate qilinmoqda aniqlang
  - Source user va device'ni identifikatsiya qiling
  - Destination va transfer method'ni tekshiring
  - DLP rule va policy violation'ni review qiling
  - Data classification va sensitivity level'ni confirm qiling
  - Incident severity va containment zarurligini baholang
type: esql
params: '{}'
schedule_interval: 10m
index:
- checkpoint-*
query_language: esql
query: |
  FROM filebeat-checkpoint-*
  | WHERE @timestamp >= NOW() - 45 minutes
  | WHERE checkpoint.dlp_rule_name IS NOT NULL
  | WHERE checkpoint.fw_action == "Block" OR checkpoint.fw_action == "Detect"
  | STATS
      event_count = COUNT(*),
      users = VALUES(source.user.name),
      dst_ips = VALUES(destination.ip),
      data_types = VALUES(checkpoint.dlp_data_type_name),
      categories = VALUES(checkpoint.dlp_categories),
      rules = VALUES(checkpoint.dlp_rule_name),
      file_names = VALUES(file.name),
      protocols = VALUES(checkpoint.dlp_transint)
    BY source.ip, bucket = DATE_TRUNC(10 minutes, @timestamp)
  | WHERE event_count >= 5
  | KEEP bucket, source.ip, event_count, users, dst_ips, data_types, categories, rules, file_names, protocols
  | SORT event_count DESC
  | LIMIT 100
enabled: true
tags:
- attack.exfiltration
- attack.t1048
- attack.t1041
- checkpoint
- dlp
- data-loss-prevention
severity: critical
risk_score: 85
references:
- "https://attack.mitre.org/techniques/T1048/"
- "https://attack.mitre.org/techniques/T1041/"
nist: ["SC-7", "AC-4"]
pci_dss: ["3.4", "10.6.1"]
gdpr: ["32", "35.7.d"]
mitre_attack:
  TA0010:
    T1048: []
    T1041: []