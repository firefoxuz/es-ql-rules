name: CheckPoint - Multiple Monitored Security Events
description: |
  Ushbu qoida CheckPoint tomonidan monitored (but not blocked) security event'larni aniqlaydi.
  Monitored action detection mode'da ishlashni yoki policy gap'ni ko'rsatishi mumkin.
  Qonuniy holatlar: policy tuning, baseline establishment, detection validation.
  SOC triage bosqichlari:
  - Nima uchun block qilinmaganini aniqlang (policy configuration)
  - Monitored event'lar orasida actual threat bormi tekshiring
  - Attack pattern va frequency'ni tahlil qiling
  - Policy adjustment zarurligini baholang
  - False positive yoki legitimate traffic ekanligini tekshiring
type: esql
params: '{}'
schedule_interval: 15m
index:
- checkpoint-*
query_language: esql
query: |
  FROM filebeat-checkpoint-*
  | WHERE @timestamp >= NOW() - 1 hour
  | WHERE checkpoint.fw_action == "Monitored"
  | STATS
      event_count = COUNT(*),
      dst_ips = VALUES(destination.ip),
      attacks = VALUES(checkpoint.attack),
      protection_names = VALUES(checkpoint.protection_name),
      severities = VALUES(event.severity),
      rules = VALUES(rule.name)
    BY source.ip, bucket = DATE_TRUNC(10 minutes, @timestamp)
  | WHERE event_count >= 15
  | KEEP bucket, source.ip, event_count, dst_ips, attacks, protection_names, severities, rules
  | SORT event_count DESC
  | LIMIT 100
enabled: true
tags:
- attack.defense-evasion
- checkpoint
- security-monitoring
- policy-gap
severity: medium
risk_score: 55
references:
- "https://attack.mitre.org/tactics/TA0005/"
nist: ["SI-4", "CA-7"]
pci_dss: ["10.6.1", "11.4"]
gdpr: ["35.7.d"]
mitre_attack:
  TA0005: {}