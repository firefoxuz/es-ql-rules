name: Nginx - Multiple Web Authentication Failures
description: |
  Ushbu qoida Nginx web server'da bir xil manbadan ko'p marta authentication failure hodisalarini aniqlaydi.
  Bu brute force attack yoki credential stuffing urinishi belgisi (T1110).
  Qonuniy holatlar: user parol xatosi, credential expiration, misconfigured client.
  SOC triage bosqichlari:
  - Source IP geo-location va reputation tekshiring
  - Target URL va authentication endpoint'ni aniqlang
  - User agent va request pattern'ini tahlil qiling
  - Muvaffaqiyatli login bo'lganmi keyinroq tekshiring
  - Rate limiting yoki IP blocking zarurligini baholang
type: esql
params: '{}'
schedule_interval: 10m
index:
- filebeat-nginx-*
query_language: esql
query: |
  FROM filebeat-nginx-*
  | WHERE @timestamp >= NOW() - 4 hours
  | WHERE data_stream.dataset == "nginx.error"
  | WHERE message RLIKE "(?i)(password mismatch|was not found in)"
  | WHERE log.level == "error"
  | STATS
      event_count = COUNT(*),
      urls = VALUES(url.original),
      user_agents = VALUES(user_agent.original),
      hosts = VALUES(host.name)
    BY source.ip, bucket = DATE_TRUNC(30 minutes, @timestamp)
  | WHERE event_count >= 8
  | KEEP bucket, source.ip, event_count, urls, user_agents, hosts
  | SORT event_count DESC
  | LIMIT 100
enabled: true
tags:
- attack.credential-access
- attack.t1110
- nginx
- web-authentication
- brute-force
severity: high
risk_score: 75
references:
- "https://attack.mitre.org/techniques/T1110/"
nist: ["AC-7", "AU-6"]
pci_dss: ["10.2.4", "10.2.5", "11.4"]
gdpr: ["32.2", "35.7.d"]
mitre_attack:
  TA0006:
    T1110: []