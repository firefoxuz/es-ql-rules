name: Log Review Activity Not Detected
description: |
  Identifies missing daily log review activity (no analyst access to SIEM/logs).
type: esql
params: '{}'
schedule_interval: 24h
index:
  - filebeat-*
  - auditbeat-*
query_language: esql
query: |
  FROM filebeat-*, auditbeat-*
  | WHERE @timestamp >= NOW() - 24 hours
  | WHERE (message RLIKE ".*(kibana|elasticsearch|siem).*"
          AND user.name IN ("security-analyst", "log-reviewer", "soc-team"))
      OR (url.path RLIKE ".*/app/kibana.*" 
          AND http.request.method IN ("GET", "POST"))
  | STATS review_sessions = COUNT(*) BY user.name
  | WHERE review_sessions >= 1
  | EVAL severity = "low"
  | KEEP @timestamp, user.name, review_sessions, severity
enabled: false
tags:
  - audit
severity: low
risk_score: 30
# MITRE ATT&CK: tactic external_id -> technique external_id -> [subtechnique external_ids]
mitre_attack: {}
nist: []
gdpr: []
pci-dss: ["10.6.1"]
hipaa: []
