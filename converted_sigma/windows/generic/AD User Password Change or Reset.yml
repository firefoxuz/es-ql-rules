rule_id: ae928f3c-348e-425f-b612-b1717b6fb50d
name: AD User Password Change or Reset
description: |
  Foydalanuvchi paroli o'zgartirilganligini aniqlaydi (Event ID 4723, 4724).
  SOC triage bosqichlari:
  - `actor` (kim o'zgartirdi) va `target_user` (kimning paroli) ni aniqlang.
  - Agar admin ko'plab foydalanuvchilar parolini ketma-ket o'zgartirsa, bu account takeover (hisobni egallash) urinishi bo'lishi mumkin.
type: esql
params: '{}'
schedule_interval: 10m
index:
- logs-winlog*
query_language: esql
query: |
  FROM logs-winlog*
  | WHERE event.code IN ("4723", "4724")
  | EVAL hostn = winlog.computer_name
  | EVAL actor = winlog.event_data.SubjectUserName
  | EVAL target_user = winlog.event_data.TargetUserName
  | KEEP agent_id, @timestamp, hostn, actor, target_user, event.code
  | SORT @timestamp DESC
  | LIMIT 100
enabled: false
tags:
  - detection.credential_access
  - monitoring.password_management
severity: medium
risk_score: 45
nist: []
pci_dss: []
gdpr: []
mitre_attack: []