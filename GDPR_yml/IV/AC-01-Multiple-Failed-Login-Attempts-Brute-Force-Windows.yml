name: Multiple Failed Login Attempts (Brute Force) - Windows
description: |
  Detects brute force login attempts on Windows by counting failed logons (Event ID 4625) from the same source IP within 5 minutes.
type: esql
params: '{}'
schedule_interval: 5m
index:
  - winlogbeat-*
  - filebeat-*
query_language: esql
query: |
  FROM winlogbeat-*, filebeat-*
  | WHERE @timestamp >= NOW() - 5 minutes
  | WHERE event.category == "authentication" 
    AND event.outcome == "failure"
  | STATS failed_attempts = COUNT(*) BY source.ip, user.name, host.name
  | WHERE failed_attempts >= 5
  | EVAL severity = "medium"
  | KEEP @timestamp, source.ip, user.name, host.name, failed_attempts, severity
enabled: false
tags:
  - access-control
severity: medium
risk_score: 50
# MITRE ATT&CK: tactic external_id -> technique external_id -> [subtechnique external_ids]
mitre_attack: {}
nist: ["AC-7", "AU-2"]
gdpr: ["IV.32.1.b", "IV.32.2"]
pci-dss: []
hipaa: []
